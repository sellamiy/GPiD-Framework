module Oopsla18
 use int.Int
 use ref.Ref

 let main (flag: bool) : unit diverges =
  let j = ref 0 in let b = ref 0 in

  while !b <= 99 do
   invariant { (flag -> !j = !b) /\ !b <= 100 }
   if flag then j := !j + 1;
   b := !b + 1
  done;

  if flag then assert { !j = 100 }

end
