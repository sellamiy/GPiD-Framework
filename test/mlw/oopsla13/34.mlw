module Oopsla34
 use int.Int
 use ref.Ref
 use int.EuclideanDivision

 let foo (n: int) : unit
   diverges
 = let x = ref 0 in
   let y = ref 0 in
   let i = ref 0 in

   while !i < n do
     (* (mod !i 2 = 0 -> !x = !y + !y) /\ (mod !i 2 <> 0 -> !x = !y + !y + 1) *)
     invariant { (mod !i 2 = 0 -> !x = !y + !y) /\ (mod !i 2 <> 0 -> !x = !y + !y + 1) }

     i := !i + 1;
     x := !x + 1;
     if mod !i 2 = 0 then y := !y + 1;
   done;

   assert { mod !i 2 = 0 -> !x = !y + !y }

end
