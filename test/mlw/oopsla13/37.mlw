module Oopsla37
 use int.Int
 use ref.Ref

 val unknown (unit) : bool

 let foo (n : int) : unit
     diverges
 = let m = ref 0 in
   let x = ref 0 in

   while !x < n do
         invariant { !m >= 0 /\ !x >= 0 /\ (n > 0 -> !m < n) }
         if unknown() then m := !x;
         x := !x + 1;
   done;

   if n > 0 then begin
      assert { !m >= 0 };
      assert { !m < n }
   end;

end
