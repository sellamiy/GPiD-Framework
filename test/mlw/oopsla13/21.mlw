module Oopsla21
 use int.Int
 use ref.Ref

 val unknown (unit) : bool

 let foo (n: int) : unit
   requires { n > 0 }
   requires { n < 10 }
   diverges
 = let c1 = ref 4000 in
   let c2 = ref 2000 in
   let v = ref 0 in
   let i = ref 0 in
   let k = ref 0 in

   while !i < n do
         invariant { true }
         i := !i + 1;
         if unknown() then v := 0 else v := 1;
         if !v = 0 then k := !k + !c1 else k := !k + !c2;

   done;

   assert { !k > n }

end
