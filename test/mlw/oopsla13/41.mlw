module Oopsla41
 use int.Int
 use ref.Ref

 val unknown (unit) : int ensures { result >= 0 }

 let main (n: int) (flag: bool) : unit
  requires { n >= 0} diverges
 = let k = ref 1 in

    if flag then begin
     k := unknown()
    end;

    let i = ref 0 in let j = ref 0 in

     while !i <= n do
      invariant { true }
      i := !i + 1;
      j := !j + !i
     done;

     let z = !k + !i + !j in assert { z > 2 * n }

end
